<html>

<head>

  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="caca.js"></script>
  
  <script>
    // PLAYER _ POSITION : <a-entity camera look-controls position-reader>
    AFRAME.registerComponent('position-reader', {
        tick: function () {
            var wposition = new THREE.Vector3();
            var wpos = this.el.object3D.getWorldPosition(wposition);
            //console.log(wpos.x+"_"+wpos.y+"_"+wpos.z);

            var pos = this.el.object3D.position;
            var xz = (wpos.x+pos.x).toFixed(2)+"_"+(wpos.z+pos.z).toFixed(2);
            console.log(xz);
            
            var rot = this.el.object3D.rotation;
            var rY = "ry ="+(rot.y*(180/Math.PI)).toFixed(2);
            //console.log(rY);

            var sceneEl = document.querySelector('a-scene');
            var info = sceneEl.querySelector('#txthead');
            //console.log(pos);
            //info.setAttribute('value', xz+"\n"+rY);
            info.setAttribute('value', xz+"\n"+rY);
            }
    });

    AFRAME.registerComponent('input-listen', {
        init: function () {
            //grip button is pressed or not _ "this.el" reffers ctlR or L in this function
            this.el.grip = false;

            //X-buttorn Pressed 
            this.el.addEventListener('xbuttondown', function (e) {
                //Start pointing position to teleport  
                this.emit('teleportstart');
            });

            //X-buttorn Released 
            this.el.addEventListener('xbuttonup', function (e) {
                //Jump to pointed position
                this.emit('teleportend');
            });

            //console.log(this);
        },

    });

</script>
  
  <meta name="apple-mobile-web-app-capable" content="yes">
</head>

<body>
  <a-scene>
    
    <a-assets>
      <img id="Sky" src="STAR.jpeg">
      <img id="mur" src="STAR.jpeg" >
      <audio id="MUSIK" src="12.mp3" autoplay="true" >

      <a-asset-item id="sol" src="L9/WATER.obj" position="0 0 0"></a-asset-item>
      <a-asset-item id="space" src="ABC.""></a-asset-item>
"
    </a-assets>

    <a-entity obj-model="obj: #sol" material="shader:displacement" ; color="blue" scale="1 1 1" >


      ></a-entity>
      <a-entity obj-model="obj: #space" ; color="blue" position="110 120 -190" animation="property: position; to: 110 1140 -190; dur: 6000; easing: linear; loop: true" rotation="0 90 0"                   scale="3 3 5"></a-entity>
    <a-sky id="image-360" radius="6000" src="#Sky" animation="property: rotation; to: 0 0 360; loop: true; dur: 30000">
    </a-sky>
    <a-text value="Bienvenue,
  trouve l'asteroide..." position="4 110 130" width="100" color="red"></a-text>


    <a-entity id="cameraRig">
      <!-- TETE -->
      <a-entity id="head" position-reader camera wasd-controls look-controls="acceleration: 1000" position="0 110 160">
          <a-text id="txthead" value="position" position="0 0 -0.5" width="5"  align="center" color="yellow">
          </a-text>
      </a-entity>
      <a-entity id="leftHand" input-listen
                hand-controls="hand: left; handModelStyle: toon; color: #ccccff"
                teleport-controls="cameraRig: #cameraRig; 
                                   teleportOrigin: #head; 
                                   startEvents: teleportstart; 
                                   endEvents: teleportend" >
                <a-text value="X: Teleport" 
                        position="0 0.08 0" rotation="-90 0 0" scale="0.1 0.1 0.1" 
                        align="center" color="#FFFFFF">
                </a-text>
            </a-entity>
            <!-- RIGH HAND -->
            <a-entity id="rightHand" 
                hand-controls="hand: right; handModelStyle: toon; color: #ccccff">
            </a-entity>
    
    <a-box src="#mur" position="0 150 108" rotation="0 65 0" depth="20" width="100" height="100"  material="shader:displacement" ></a-box>
    <a-box src="#mur" position="60 150 108" rotation="0 75 0" depth="20" width="100" height="100" material="shader:displacement" ></a-box>
    <a-box src="#mur" position="40 150 10" rotation="0 0 0" depth="20" width="100" height="100"  material="shader:displacement"></a-box>
    <a-box src="#mur" position="-22 150 60" rotation="0 0 0" depth="20" width="100" height="100"  material="shader:displacement"></a-box>
    <a-box src="#mur" position="113 150 60" rotation="0 0 0" depth="20" width="100" height="100" material="shader:displacement" ></a-box>
    <a-box src="#mur" position="109 150 5" rotation="0 75 0" depth="20" width="100" height="100" material="shader:displacement" ></a-box>
    <a-box  src="#mur" position="-50 150 10" rotation="0 65 0" depth="20" width="100" height="100"  material="shader:displacement"></a-box>
    <a-box  src="#mur" position="-16 150 -50" rotation="0 0 0" depth="20" width="100" height="100"  material="shader:displacement"></a-box>
    <a-box src="#mur" position="30 150  -90" rotation="0 75 0" depth="20" width="100" height="100"  material="shader:displacement"></a-box>
    <a-box src="#mur" position="125 150  -90" rotation="0 75 0" depth="20" width="100" height="100" material="shader:displacement" ></a-box>
    <a-box src="#mur"  position="80 150  -90" rotation="0 75 0" depth="10" width="100" height="100"  material="shader:displacement"></a-box>
    <a-torus position="80 150  -90" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -70" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -60" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -80" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -50" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -40" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -30" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -20" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -10" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  0" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  10" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  20" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  30" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  40" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  50" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  100" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  110" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  120" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  130" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  140" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  60" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  70" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  80" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  90" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -100" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -110" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -120" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -130" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -140" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -150" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -160" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -170" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -180" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -190" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -200" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -210" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -220" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -230" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -240" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -250" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -260" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -270" rotation= "0 0 0" radius="300"  ></a-torus></body>
    <a-torus position="80 150  -280" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -290" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -300" rotation= "0 0 0" radius="300"  ></a-torus>
    <a-torus position="80 150  -310" rotation= "0 0 0" radius="300"  ></a-torus>
</html>
